--gestion de excepciones
--cuando se quieren capturar los errores
DECLARE
  NOMBRE PRODUCTS.PRODUCT_NAME%TYPE;
  FECHA DATE;
  CODIGO_ERROR NUMBER;
  MENSAJE_ERROR VARCHAR2(1000);
BEGIN
  FECHA:=SYSDATE;
  SELECT PRODUCT_NAME INTO NOMBRE FROM PRODUCTS WHERE PRODUCT_ID = '10000';
  
  DBMS_OUTPUT.PUT_LINE('EL NOMBRE DEL PRODUCTO ES: '|| NOMBRE);
  --bloque para las excepciones
  EXCEPTION 
      WHEN TOO_MANY_ROWS THEN
        CODIGO_ERROR:=SQLCODE;
        MENSAJE_ERROR:=SQLERRM;
        --SQLCODE retorna el codigo de error es un codigo numerico
        DBMS_OUTPUT.PUT_LINE('SE RETORNAN MUCHOS REGISTROS EN LA SENTENCIA SELECT. EL CODIGO DEL ERROR ES: '|| CODIGO_ERROR);
        
        --SQLERRM mensaje con el codigo de error
        DBMS_OUTPUT.PUT_LINE(MENSAJE_ERROR);
        
        --OTHERS captura cualquier excepcion
      WHEN OTHERS THEN 
      IF (SQLCODE=-1858)THEN
        CODIGO_ERROR:=SQLCODE;
        MENSAJE_ERROR:=SQLERRM;
        DBMS_OUTPUT.PUT_LINE('SE ESTAN ASIGNANDO TIPOS DE DATOS INCOMPATIBLES');
        DBMS_OUTPUT.PUT_LINE(CODIGO_ERROR);
        DBMS_OUTPUT.PUT_LINE(MENSAJE_ERROR);
      END IF;
      
      IF (SQLCODE=100) THEN
        CODIGO_ERROR:=SQLCODE;
        MENSAJE_ERROR:=SQLERRM;
        DBMS_OUTPUT.PUT_LINE('EL SELECT INTO NO ENCONTRO DATOS');
        DBMS_OUTPUT.PUT_LINE(CODIGO_ERROR);
        DBMS_OUTPUT.PUT_LINE(MENSAJE_ERROR);
      END IF;
      
END;

