CREATE OR REPLACE PROCEDURE SP_INSERTA_PRODUCT (NOMBRE_PROD VARCHAR2, ID_BRAND IN  NUMBER, CAT_ID NUMBER, 
ANIO_MODELO NUMBER,PRECIO NUMBER, BRAND_NOMBRE IN VARCHAR2,MSJ_ERROR OUT VARCHAR2, MSJ_EXITO OUT VARCHAR2)
IS
  CANTIDAD_REGISTROS NUMBER;
  COD_BRAND NUMBER;
BEGIN
  SELECT COUNT(*) INTO CANTIDAD_REGISTROS FROM BRANDS WHERE BRAND_ID=ID_BRAND;
  
  IF (CANTIDAD_REGISTROS=1)THEN
       INSERT INTO PRODUCTS(PRODUCT_NAME,BRAND_ID,CATEGORY_ID,MODEL_YEAR,LIST_PRICE) VALUES(NOMBRE_PROD,ID_BRAND,CAT_ID,ANIO_MODELO,PRECIO);
       COMMIT;
       MSJ_EXITO:='LA INSERCION DEL PRODUCTO FUE EXITOSA';
       --CREAR UN PROCEDIMIENTO PARA USAR EL ELSE
      ELSE
        PS_INSERTA_BRANDS(BRAND_NOMBRE, COD_BRAND);
        INSERT INTO PRODUCTS(PRODUCT_NAME,BRAND_ID,CATEGORY_ID,MODEL_YEAR,LIST_PRICE) VALUES(NOMBRE_PROD,COD_BRAND,CAT_ID,ANIO_MODELO,PRECIO);
        COMMIT;
        MSJ_EXITO:='LA INSERCION DEL PRODUCTO FUE EXITOSA';
  END IF;
  
  EXCEPTION 
     WHEN OTHERS THEN
     MSJ_ERROR:= SQLERRM;
  
END;

DECLARE
  MSJ_ERROR VARCHAR2(500);
  MSJ_EXITO VARCHAR2(500);
BEGIN
  SP_INSERTA_PRODUCT('BICICLETA DE PRUEBA 1',1,30,2018,333,'BRAND PRUEBA',MSJ_ERROR,MSJ_EXITO);
  DBMS_OUTPUT.put_line(MSJ_EXITO||' '||MSJ_ERROR);
END;

