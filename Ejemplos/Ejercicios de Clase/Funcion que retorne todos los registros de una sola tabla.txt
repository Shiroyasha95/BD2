--FUNCION QUE RETORNE MAS DE UN REGISTRO 
--RETORNE TODAS LAS CATEGORIAS

CREATE OR REPLACE FUNCTION FN_INF_CATEGORIAS
-- DEBE REGRESAR UN CURSOR
RETURN SYS_REFCURSOR
IS
   CDATOS SYS_REFCURSOR;
   
BEGIN
--ABRIR EL CURSOR
   OPEN CDATOS FOR SELECT CATEGORY_ID,CATEGORY_NAME FROM CATEGORIES WHERE CATEGORY_ID>3;
   RETURN CDATOS;
END;

DECLARE
   DATOS_CAT SYS_REFCURSOR;
   REGISTROS CATEGORIES%ROWTYPE;
BEGIN
    DATOS_CAT:=FN_INF_CATEGORIAS;
    -- RECORRER CON UN CICLO
    LOOP
      FETCH DATOS_CAT INTO REGISTROS;
      --SALIR CUANDO NO ENCUENTRE NADA
      EXIT WHEN DATOS_CAT%NOTFOUND;
      DBMS_OUTPUT.PUT_LINE('EL ID DE LA CATEGORIA ES: '||REGISTROS.CATEGORY_ID);
      DBMS_OUTPUT.PUT_LINE('EL NOMBRE DE LA CATEGORIA ES: '||REGISTROS.CATEGORY_NAME);
      
    END LOOP;
END;
